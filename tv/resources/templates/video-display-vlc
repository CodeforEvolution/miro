<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:t="http://www.participatorypolitics.org/"
      xmlns:i18n="http://www.participatoryculture.org/i18n"
      eventCookie="@@@eventCookie@@@" dtvPlatform="@@@dtvPlatform@@@">
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
</head>
<t:include filename="dynamic.js" />
<script type="text/javascript">

function getServerPort() {
  var port = document.location.port;
  return port;
}
// Returns a "blessed" version of an event URL for use with DTV
function blessEventURL(url) {
  var blessedURL = "http://127.0.0.1:" + getServerPort() + "/dtv/action/" + getEventCookie() + "?" + url;
  return blessedURL;
}
function videoSetVolume(level) {
  dump("Setting volume to "+level);
  document.video1.set_volume(level*200);
}
function videoPlay(url) {
  // FIXME: race condition
  if(typeof this.lastURL == 'undefined')
          this.lastURL = '';
  if(this.lastURL != url) {
    dump('playing new\n');
    document.video1.stop();
    document.video1.clear_playlist();
    document.video1.add_item(url);
    document.video1.add_item(blessEventURL('action:videoNext'));
    this.lastURL = url;
    document.video1.play();
  } else {
    dump('playing again\n');
    document.video1.play();
  }
}
function videoPause() {
  dump("pausing\n");
  document.video1.pause();
}
function videoStop() {
  dump("stopping\n");
  document.video1.stop();
}
function videoReset() {
  dump("reseting\n");
  document.video1.seek(0,0);
}
function videoFullscreen() {
  dump("fsing\n");
  document.video1.fullscreen();
}
</script>
<body onload="beginUpdates();">
<embed type="application/x-vlc-plugin"
         name="video1"
         autostart="0" style="position: absolute; top: 0px;bottom: 0px; left: 0px; right: 0px" id="video1"/>
</body>
</html>
