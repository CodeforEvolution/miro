<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:t="http://www.participatorypolitics.org/"
      xmlns:i18n="http://www.participatoryculture.org/i18n"
      eventCookie="@@@eventCookie@@@" dtvPlatform="@@@dtvPlatform@@@">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <t:include filename="dynamic.js" />
    <t:execOnLoad><![CDATA[
try:
    this = kargs['this']
except:
    pass
try:
    viewName = kargs['viewName']
except:
    pass
]]></t:execOnLoad>
</head>

<body>

<div class="main-video draggable ***this.getSelected() and 'selected' or ''***" 
	dragsourcetype="***this.getDragType()***" dragicon="video-tnail-***this.getID()***" 
	selectID="***this.getID()***" selectViewName="@@@viewName@@@"
	onmousedown="return handleSelect(event)"
	onmouseup="return handleSelect(event)" >
    <div class="main-video-hitbox">
        <a t:showIf="this.getState() in ('new', 'not-downloaded', 'expired')"
            class="download-icon" href="#" 
            title="Download '***this.getTitle()***'" 
            onclick="return eventURL('action:startDownload?item=@@@this.getID()@@@');"  />
        <span t:showIf="this.getState() == 'downloading'"
            class="inprogress-background" 
            title="Downloading '***this.getTitle()***'">
            <img class="inprogress-arrows"  
                src="resource:images/main-video-inprogress-arrows.gif" />
        </span>
        <a t:showIf="this.isDownloaded() and not this.isContainerItem"
            class="play-icon" href="#" 
            title="Play '***this.getTitle()***'" 
            onclick="return eventURL('action:playViewNamed?viewName=@@@viewName@@@&amp;firstItemId=@@@this.getID()@@@');" />
    </div>
    <img class="main-video-tnail" src="***this.getThumbnail()***" alt="" id="video-tnail-***this.getID()***" />

    <div class="main-video-details">
        <div class="main-video-details-tasks">
            <a t:showIf="this.hasSharableURL()" href="#" 
                class="main-video-details-task-mail" 
                onclick="recommendItem('@@@this.getTitle()@@@', '@@@this.getURL()@@@', '@@@this.getFeed().getURL()@@@'); return false;" />
            <a href="#" t:showIf="this.hasSharableURL()" 
                class="main-video-details-task-bomb" 
                onclick="return eventURL('action:videoBombExternally?item=@@@this.getID()@@@');" />
            <a t:showIf="this.isDownloaded()" href="#" 
                class="main-video-details-task-delete" 
                onclick="return eventURL('action:expireItem?item=@@@this.getID()@@@');" />
        </div>
	<div t:hideIf="this.getState() == 'downloading'"
		class="main-video-details-state @@@this.getStateCSSClass()@@@">
		<div t:showIf="this.showSaveButton()"
		    class="main-video-details-save-button">
		    <a href="#" 
		       onclick="return eventURL('action:keepItem?item=@@@this.getID()@@@');"
		       i18n:translate="">SAVE</a>
		</div>
		<span t:replace="this.getStateString()" />
	</div>
	<div t:showIf="this.getState() == 'downloading'"
		class="main-video-details-download-info">
	    <div class="main-progress-bar-bg">
	        <div class="main-progress-bar" 
		    style="width: ***this.downloadProgressWidth()***px;" />
	    </div>
            <span t:replace="this.downloadETA()" />
            <span t:hideIf="this.downloadRate() == '0k/s'">
                    <span t:replace="this.downloadRate()" />
            </span>
            <a class="main-progress-cancel" href="#" onclick="return eventURL('action:expireItem?item=@@@this.getID()@@@');" title="Cancel Download" />
        </div>
    </div>
    <div class="main-video-desc noselect">
        <h1 t:replace="this.getTitle()" class="noselect"/>
        <div class="main-video-desc-desc noselect">
            <p t:replaceMarkup="this.getDescription()" />
        </div>
	<div class="main-video-desc-details noselect">
		<span t:replaceMarkup="this.getDetails()" />
	</div>
    </div>
</div>


</body>
</html>
