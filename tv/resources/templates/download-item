<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:t="http://www.participatorypolitics.org/"
      xmlns:i18n="http://www.participatoryculture.org/i18n"
      eventCookie="@@@eventCookie@@@" dtvPlatform="@@@dtvPlatform@@@">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <t:include filename="dynamic.js" />
</head>

<body>

<div class="main-video">
    <div class="main-video-hitbox">
        <a t:showIf="this.getState() in ('new', 'not-downloaded', 'expired')"
            class="download-icon" href="#" 
            title="Download '***this.getTitle()***'" 
            onclick="return eventURL('action:startDownload?item=@@@this.getID()@@@');"  />
        <span t:showIf="this.getState() == 'downloading'"
            class="inprogress-background" 
            title="Downloading '***this.getTitle()***'">
            <img class="inprogress-arrows"  
                src="resource:images/main-video-inprogress-arrows.gif" />
        </span>
        <a t:showIf="this.isDownloaded()"
            class="play-icon" href="#" 
            title="Play '***this.getTitle()***'" 
            onclick="return eventURL('action:playViewNamed?viewName=@@@viewName@@@&amp;firstItemId=@@@this.getID()@@@');" />
    </div>
    <img class="main-video-tnail" src="***this.getThumbnail()***" alt="" />

    <div class="main-video-details">
        <div class="main-video-details-tasks">
            <a t:hideIf="this.getURL() == ''" href="#" 
                class="main-video-details-task-mail" 
                onclick="recommendItem('@@@this.getTitle()@@@', '@@@this.getURL()@@@', '@@@this.getFeed().getURL()@@@'); return false;" />
            <a href="#" t:hideIf="this.getURL() == ''" 
                class="main-video-details-task-bomb" 
                onclick="return eventURL('action:videoBombExternally?item=@@@this.getID()@@@');" />
            <a t:showIf="this.isDownloaded()" href="#" 
                class="main-video-details-task-delete" 
                onclick="return eventURL('action:expireItem?item=@@@this.getID()@@@');" />
        </div>
        <div t:hideIf="this.getViewed()" class="main-video-details-state new">
            <span i18n:translate="">NEW</span>
        </div>
        <div t:showIf="this.getState() == 'unwatched'"
             class="main-video-details-state unwatched" >
             <span i18n:translate="">UNWATCHED</span>
        </div>
        <div t:showIf="this.getState() == 'expiring'"
            class="main-video-details-state expiry">
            <span i18n:translate="">Expires: <span i18n:name="expiration"
                    t:replace="this.getExpirationString()" /></span>
        </div>
	<div t:showIf="this.isPendingAutoDownload()" class="main-video-details-state-secondary">
            <span i18n:translate="">Pending Auto Download</span>
        </div>
	<div t:showIf="this.isFailedDownload()" class="main-video-details-state-secondary">
		<span t:replace="this.getFailureReason()" />
	</div>
        <div t:showIf="this.getState() == 'downloading'" 
            class="main-video-details-state downloading">
            <div class="main-progress-bar">
                <img src="resource:images/status.png" width="@@@this.downloadProgressWidth()@@@" height="12" />
            </div>
            <span t:replace="this.downloadETA()" />
            <span t:hideIf="this.downloadRate() == '0k/s'">
                    <span t:replace="this.downloadRate()" />
            </span>
            <a class="main-progress-cancel" href="#" onclick="return eventURL('action:expireItem?item=@@@this.getID()@@@');" title="Cancel Download" />
        </div>
        <div t:showIf="this.isDownloaded()"
            class="main-video-details-save-button">
            <a href="#" 
               onclick="return eventURL('action:keepItem?item=@@@this.getID()@@@');"
               i18n:translate="">SAVE</a>
        </div>
    </div>
    <div class="main-video-desc">
        <h1 t:replace="this.getTitle()" />
        <div class="main-video-desc-desc">
            <p t:replaceMarkup="this.getDescription()" />
        </div>
        <span t:replaceMarkup="this.getDetails()" />
    </div>
</div>


</body>
</html>
