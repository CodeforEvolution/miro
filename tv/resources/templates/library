<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:t="http://www.participatorypolitics.org/"
      xmlns:i18n="http://www.participatoryculture.org/i18n"
      eventCookie="@@@eventCookie@@@" dtvPlatform="@@@dtvPlatform@@@">
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />

<link href="resource:css/main.css" rel="stylesheet" type="text/css" />
<t:include filename="dynamic.js" />
<t:include filename="settings.js" />
    <t:execOnLoad><![CDATA[
global searchFilter
searchFilter = lambda x: filters.matchingItems(x, None)

watchableItems = views.items.filter(filters.watchableItems)

matchingItems = watchableItems.filter(lambda x:searchFilter(x))
libraryItems = matchingItems.sort(sorts.item)

def updateSearchString(newSearch):
    global searchFilter
    if len(newSearch) == 0:
        searchFilter = lambda x: filters.matchingItems(x, None)
    else:
        searchFilter = lambda x: filters.matchingItems(x, newSearch)
    watchableItems.recomputeFilter(matchingItems)

]]>
    </t:execOnLoad>
    <t:execOnUnload><![CDATA[
# This should unlink matchingItems and all of it's children
watchableItems.unlink()
]]>
    </t:execOnUnload>

</head>

<body>

<!-- TITLE BAR ************************************************************ -->
<div id="main-titlebar">
	<div id="main-titlebar-avatar" style="border:0px;"><img src="resource:images/collection-icon.png" /></div>
	<div id="main-titlebar-channelname">
		<h1 i18n:translate="">My Collection</h1>
	</div>
	<div id="main-titlebar-tasks" style="width:100%; text-align:center;">
		<div id="main-titlebar-tasks-search">
		    <input type="search" placeholder="Search Videos" class="main-titlebar-tasks-search"  style="margin:35px 55px 0px 0px; width:200px; font-size: 120%;" onfocus="startEditSearch(this)" onblur="endEditSearch()" />
		</div>
	</div>
</div>
<!-- / TITLE BAR -->

<div id="main-container">

	<!-- VIDEOS ************************************************** -->
	<div>
    	<span t:repeatForView="libraryItems">
    	<t:includeTemplate filename="download-item" />
   		</span>
	</div>
	<!-- / VIDEOS -->
	
</div>

</body>
</html>
