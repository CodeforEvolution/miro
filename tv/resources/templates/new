<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      eventCookie="@@@eventCookie@@@" dtvPlatform="@@@dtvPlatform@@@">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    <link href="resource:css/main.css" rel="stylesheet" type="text/css" />
    <t:include filename="dynamic.js" />
    <t:include filename="settings.js" />
    <script type="text/javascript" src="resource:templates/osxdnd.js" />

    <t:execOnLoad><![CDATA[
sorts.switchUnwatchedFirstChannel(None)

global searchFilter

searchFilter = lambda x: filters.matchingItems(x, None)

matchingItems = views.newWatchableItems.filter(lambda x:searchFilter(x),sortFunc=sorts.itemsUnwatchedFirst)

def updateSearchString(newSearch):
    global searchFilter
    if len(newSearch) == 0:
        searchFilter = lambda x: filters.matchingItems(x, None)
    else:
        searchFilter = lambda x: filters.matchingItems(x, newSearch)
    views.newWatchableItems.recomputeFilter(matchingItems)

def setSortBy(by, handle):
    sorts.setSortBy(by)
    views.watchableItems.recomputeFilter(matchingItems)
    handle.forceUpdate()
]]>
    </t:execOnLoad>
    <t:execOnUnload><![CDATA[
matchingItems.unlink()
]]>
    </t:execOnUnload>

</head>

<body onkeydown="sendKeyToSearchBox(event);">

<!-- TITLE BAR ************************************************************ -->
<div id="main-titlebar">
    <div id="main-icon" class="noborder"><img src="resource:images/newvideos-icon.png" /></div>
    <h1 id="main-title" i18n:translate="">New Videos</h1>
    <div id="search-box-container">
        <input id="search-box" type="search" onfocus="onSearchFocus(this)" onblur="endEditSearch()" value="***_('Find')***"/>
    </div>
</div>
<!-- / TITLE BAR -->

<div id="main-container">
    <span t:updateForView="matchingItems">
        <div t:hideIf="matchingItems.len() == 0">
            <t:includeTemplate filename="static-tab-sort-bar" />
        </div>
    </span>
    <div id="main-unwatched">
	<div t:repeatForView="matchingItems" t:repeatTemplate='download-item' />
    </div>	
</div>

</body>
</html>
